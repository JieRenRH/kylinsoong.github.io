---
layout: blog
title:  "Teiid Materialized Views"
date:   2015-05-26 18:00:00
categories: teiid
permalink: /teiid-mat-view
author: Kylin Soong
duoshuoid: ksoong2015052601
excerpt: Teiid Materialized Views Usage Example
---

* Table of contents
{:toc}

## Materialized Views

Teiid Materialized views are just like other views, but their transformations are pre-computed and stored just like a regular table. When queries are issued against the views through the Teiid Server, the cached results are used.

There are 2 categories of Materialization:

* External Materialization - External materialized views cache their data in an external database system. External materialized views give the administrator full control over the loading and refresh strategies.
* Internal Materialization - Internal materialization creates Teiid temporary tables to hold the materialized table. While these tables are not fully durable, they perform well in most circumstances and the data is present at each Teiid instance which removes the single point of failure and network overhead of an external database. Internal materialization also provides more built-in facilities for refreshing and monitoring. 

Detailed documentation from [Teiid doc](https://teiid.gitbooks.io/documents/content/caching/Materialized_Views.html).

## Internal Materialization

An Internal Materialization have to meet the following 3 conditions:

1. the view should be VIRTUAL, which means the View should be in a `VIRTUAL` model
2. `materialized` have to be set and value should be true
3. `teiid_rel:ALLOW_MATVIEW_MANAGEMENT` should be added and value should be true

[A Sample Internal Materialization View](#A Sample Internal Materialization View)

### A Sample Internal Materialization View

~~~
<model name="StocksMatModel" type="VIRTUAL">
    <metadata type="DDL"><![CDATA[
        CREATE view stockPricesInterMatView
                (
            product_id integer,
            symbol string,
            price bigdecimal,
            company_name   varchar(256)
                ) OPTIONS (materialized true,         
               "teiid_rel:ALLOW_MATVIEW_MANAGEMENT" 'true', 
               "teiid_rel:MATVIEW_PREFER_MEMEORY" 'true',
               "teiid_rel:MATVIEW_TTL" 600000,
               "teiid_rel:MATVIEW_UPDATABLE" 'true', 
               "teiid_rel:MATVIEW_SCOPE" 'VDB')
               AS SELECT  A.ID, S.symbol, S.price, A.COMPANY_NAME FROM Stocks.StockPrices AS S, Accounts.PRODUCT AS A WHERE S.symbol = A.SYMBOL;
        ]]>
    </metadata>
</model>
~~~ 

## MaterializationManager FinishDeployment

![MaterializationManager]({{ site.baseurl }}/assets/blog/teiid-finish-deployment.png)
